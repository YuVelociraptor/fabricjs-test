<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <title>fabricjs test</title>
    <script src="https://cdn.jsdelivr.net/npm/fabric@latest/dist/index.min.js"></script>
</head>

<body>

<div id="canvas-container" style="position: relative; width: 500px; height: 500px;">
    <canvas id="fabric-layer" width="800" height="600" style="border: 1px solid black;"></canvas>
</div>

<script>
    // Fabric.js キャンバスの初期化
    const canvas = new fabric.Canvas('fabric-layer');

    // 四角形を追加
    const rect = new fabric.Rect({
        left: 100,
        top: 100,
        fill: 'blue',
        width: 100,
        height: 100,
        angle: 0,
    });
    canvas.add(rect);

    // テキストを追加
    const text = new fabric.Text('Hello Fabric.js!', {
        left: 200,
        top: 200,
        fontSize: 24,
        fill: 'green',
    });
    canvas.add(text);

    // イベントリスナー
    canvas.on('mouse:down', function (event) {
        console.log('Canvas clicked at', event.pointer);
    });


    // 付箋の背景
    const stickyNote = new fabric.Rect({
        left: 150,
        top: 150,
        fill: 'yellow',
        width: 200,
        height: 150,
        cornerRadius: 10, // Fabric.jsでは `cornerRadius` がデフォルトサポートされていないため要カスタム
    });

    // 付箋のテキスト
    const noteText = new fabric.Textbox('This is a sticky note!', {
        left: 160,
        top: 160,
        fontSize: 18,
        width: 180,
        fill: 'black',
    });

    // グループ化して付箋を一つのオブジェクトとして扱う
    const stickyNoteGroup = new fabric.Group([stickyNote, noteText], {
        left: 150,
        top: 150,
        lockRotation: true, // 回転禁止 (必要ならコメントアウト)
    });

    // キャンバスに追加
    canvas.add(stickyNoteGroup);

    // リサイズ、移動、回転の有効化 (Fabric.jsの標準機能)
    stickyNoteGroup.set({
        lockUniScaling: false, // 幅と高さを個別に変更可能にする
    });

    // 描画更新
    canvas.renderAll();

    // イベントリスナー: サイズや位置を変更した後に更新
    canvas.on('object:modified', (event) => {
        console.log('Object modified:', event.target);
    });
</script>


</body>
</html>